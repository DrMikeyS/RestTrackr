"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[118],{1118:(b,S,l)=>{l.r(S),l.d(S,{ViewResultsPage:()=>m});var _=l(467),h=l(177),D=l(4341),f=l(8285),e=l(4438),F=l(8889),R=l(755);function P(a,d){if(1&a&&(e.qex(0),e.j41(1,"tr")(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s()(),e.bVm()),2&a){const t=d.$implicit;e.R7$(3),e.JRh(t.variableID),e.R7$(2),e.JRh(t.variableValue),e.R7$(2),e.JRh(t.sleepCount),e.R7$(2),e.JRh(t.poorSleepPercentage),e.R7$(2),e.JRh(t.okSleepPercentage),e.R7$(2),e.JRh(t.greatSleepPercentage)}}function v(a,d){if(1&a&&(e.j41(0,"table")(1,"thead")(2,"tr")(3,"th"),e.EFF(4,"Variable ID"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Variable Value"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Sleep count"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Poor Sleep"),e.k0s(),e.j41(11,"th"),e.EFF(12,"OK Sleep"),e.k0s(),e.j41(13,"th"),e.EFF(14,"Great Sleep"),e.k0s()()(),e.j41(15,"tbody"),e.DNE(16,P,14,6,"ng-container",2),e.k0s()()),2&a){const t=e.XpG();e.R7$(16),e.Y8G("ngForOf",t.results)}}function k(a,d){1&a&&(e.j41(0,"div"),e.EFF(1," No results found. "),e.k0s())}let m=(()=>{class a{constructor(t,o){this.configService=t,this.indexedDbService=o,this.configData=null,this.tableData=[],this.results=[]}ngOnInit(){this.loadConfig(),this.loadTableData()}loadConfig(){var t=this;return(0,_.A)(function*(){try{yield t.configService.loadConfig(),t.configData=t.configService.ConfigData}catch(o){console.error("Error loading config:",o),t.configData=null}})()}getRangeOptions(t){return Array.from({length:t},(o,n)=>n+1)}loadTableData(){var t=this;return(0,_.A)(function*(){try{const o=yield t.indexedDbService.getAllEntries();t.populateTable(o)}catch(o){console.error("Error fetching sleep logs:",o)}})()}populateTable(t){var o=this;return(0,_.A)(function*(){yield o.configService.loadConfig(),o.configData=o.configService.ConfigData;const n=[];o.configData&&(o.configData.variables.forEach(i=>{if("bool"===i.type)[!0,!1].forEach(r=>{let c=0,u=0,p=0;t.forEach(s=>{const g=s.variables.find(C=>C.id===i.id);g&&g.value===r&&("great"===s.sleepQuality?p++:"ok"===s.sleepQuality?u++:"poor"===s.sleepQuality&&c++)}),n.push({variableID:i.name,variableValue:r,poorSleepCount:c,okSleepCount:u,greatSleepCount:p})});else if("range"===i.type){console.log(i.name);for(let r=0;r<=i.range.size;r++){let c=0,u=0,p=0;t.forEach(s=>{const g=s.variables.find(C=>C.id===i.id);g&&g.value===r&&("great"===s.sleepQuality?p++:"ok"===s.sleepQuality?u++:"poor"===s.sleepQuality&&c++)}),n.push({variableID:i.name,variableValue:r,poorSleepCount:c,okSleepCount:u,greatSleepCount:p})}}}),o.results=n,o.calculatePercentages(),console.log(o.results))})()}calculatePercentages(){this.results.forEach(t=>{const o=t.poorSleepCount+t.okSleepCount+t.greatSleepCount;t.sleepCount=o,t.poorSleepPercentage=t.poorSleepCount/o*100,t.okSleepPercentage=t.okSleepCount/o*100,t.greatSleepPercentage=t.greatSleepCount/o*100})}static#e=this.\u0275fac=function(o){return new(o||a)(e.rXU(F.w),e.rXU(R.T))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-view-results"]],standalone:!0,features:[e.aNF],decls:9,vars:2,consts:[[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(o,n){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3," View Results "),e.k0s()()(),e.j41(4,"ion-content",0)(5,"h2"),e.EFF(6,"Results"),e.k0s(),e.DNE(7,v,17,1,"table",1)(8,k,2,0,"div",1),e.k0s()),2&o&&(e.R7$(7),e.Y8G("ngIf",n.results&&n.results.length>0),e.R7$(),e.Y8G("ngIf",!n.results||0===n.results.length))},dependencies:[f.W9,f.BC,f.ai,f.eU,h.MD,h.Sq,h.bT,D.YN]})}return a})()}}]);